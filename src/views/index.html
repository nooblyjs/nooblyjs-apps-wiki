<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wiki</title>
    <link rel="stylesheet" href="/styles.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet">

    <!-- Bootstrap 5 JavaScript Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</head>
<body>
    <!-- Login/Register Page -->
    <div id="loginPage" class="min-vh-100 d-flex align-items-center justify-content-center bg-light">
        <div class="card shadow-lg" style="width: 100%; max-width: 400px;">
            <div class="card-body p-4">
                <div class="text-center mb-4">
                    <i class="bi bi-journal-bookmark fs-1 text-primary mb-3"></i>
                    <h1 class="h3 mb-2">Wiki</h1>
                    <p class="text-muted">Knowledge Management Platform</p>
                </div>

                <!-- Login Form -->
                <form id="loginForm">
                    <div class="mb-3">
                        <label for="username" class="form-label">Email</label>
                        <input type="email" class="form-control" id="username" name="username" required>
                    </div>
                    <div class="mb-3">
                        <label for="password" class="form-label">Password</label>
                        <input type="password" class="form-control" id="password" name="password" required>
                    </div>
                    <div id="loginError" class="alert alert-danger hidden"></div>
                    <button type="submit" class="btn btn-primary w-100">Login</button>
                </form>

                <!-- Register Form (Hidden by default) -->
                <form id="registerForm" class="hidden">
                    <div class="mb-3">
                        <label for="registerName" class="form-label">Full Name</label>
                        <input type="text" class="form-control" id="registerName" name="name" required>
                    </div>
                    <div class="mb-3">
                        <label for="registerEmail" class="form-label">Email</label>
                        <input type="email" class="form-control" id="registerEmail" name="email" required>
                    </div>
                    <div class="mb-3">
                        <label for="registerPassword" class="form-label">Password</label>
                        <input type="password" class="form-control" id="registerPassword" name="password" minlength="6" required>
                        <small class="form-text text-muted">Minimum 6 characters</small>
                    </div>
                    <div class="mb-3">
                        <label for="registerPasswordConfirm" class="form-label">Confirm Password</label>
                        <input type="password" class="form-control" id="registerPasswordConfirm" name="passwordConfirm" minlength="6" required>
                    </div>
                    <div id="registerError" class="alert alert-danger hidden"></div>
                    <button type="submit" class="btn btn-primary w-100">Register</button>
                </form>

                <!-- Toggle between Login and Register -->
                <div class="text-center mt-3">
                    <a href="#" id="toggleAuthMode" class="text-decoration-none">
                        <small>Don't have an account? <span class="text-primary fw-bold">Register</span></small>
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Wiki Application -->
    <div id="wikiApp" class="hidden">
        <!-- Header -->
        <header class="navbar navbar-expand-lg app-header">
            <div class="container-fluid">
                <a class="navbar-brand d-flex align-items-center" href="#">
                    <i class="bi bi-journal-bookmark me-2"></i>
                    <span>Wiki</span>
                </a>

                <!-- Search Bar -->
                <div class="flex-grow-1 mx-4 position-relative">
                    <div class="input-group">
                        <span class="input-group-text bg-transparent border-0 text-white-50">
                            <i class="bi bi-search"></i>
                        </span>
                        <input type="text" id="globalSearch" placeholder="Search knowledge base..." class="form-control search-input border-0">
                    </div>
                    <div id="searchSuggestions" class="position-absolute top-100 start-0 w-100 bg-white border shadow-sm hidden">
                        <!-- Search suggestions will be populated here -->
                    </div>
                </div>

                <!-- User Profile and Navigation -->
                <div class="navbar-nav d-flex flex-row align-items-center">
                    <!-- Create Dropdown -->
                    <div class="dropdown me-3">
                        <button class="btn btn-light btn-sm dropdown-toggle" type="button" id="createDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                            <i class="bi bi-plus-lg me-1"></i>
                            Create
                        </button>
                        <ul class="dropdown-menu" aria-labelledby="createDropdown">
                            <li><a class="dropdown-item" href="#" id="createFolderMenuItem">
                                <i class="bi bi-folder-plus me-2"></i>Create Folder
                            </a></li>
                            <li><a class="dropdown-item" href="#" id="createFileMenuItem">
                                <i class="bi bi-file-earmark-plus me-2"></i>Create File
                            </a></li>
                            <li><a class="dropdown-item" href="#" id="uploadFileMenuItem">
                                <i class="bi bi-upload me-2"></i>Upload File
                            </a></li>
                        </ul>
                    </div>

                    <div id="userProfile" class="nav-item dropdown me-3" title="Click to edit profile">
                        <a class="nav-link dropdown-toggle d-flex align-items-center text-white" href="#" data-bs-toggle="dropdown">
                            <div class="bg-light rounded-circle d-flex align-items-center justify-content-center me-2" style="width: 32px; height: 32px;">
                                <span id="userInitials" class="text-primary fw-bold">AD</span>
                            </div>
                            <div class="d-none d-md-block">
                                <div id="userName" class="small">Admin User</div>
                                <div id="userRole" class="text-white-50" style="font-size: 0.75rem;">Administrator</div>
                            </div>
                        </a>
                        <ul class="dropdown-menu dropdown-menu-end">
                            <li><a class="dropdown-item" href="#"><i class="bi bi-person me-2"></i>Profile</a></li>
                            <li><a class="dropdown-item" href="#"><i class="bi bi-gear me-2"></i>Settings</a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li><a class="dropdown-item" href="#" id="logoutBtn"><i class="bi bi-box-arrow-right me-2"></i>Logout</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </header>

        <div class="d-flex">
            <!-- Left Sidebar -->
            <aside id="leftSidebar" class="app-sidebar bg-light border-end p-3 overflow-auto">
                <!-- Collapsible Shortcuts Section -->
                <div class="mb-4">
                    <div class="d-flex align-items-center mb-2" id="shortcutsHeader" data-bs-toggle="collapse" data-bs-target="#shortcutsContent" role="button">
                        <i class="bi bi-chevron-down me-2"></i>
                        <span class="fw-semibold text-uppercase small text-muted">Shortcuts</span>
                    </div>
                    <div id="shortcutsContent" class="collapse show">
                        <nav class="nav flex-column">
                            <a href="#" id="shortcutHome" class="nav-link text-dark d-flex align-items-center py-2 px-2 rounded">
                                <i class="bi bi-house me-2"></i>
                                <span>Home</span>
                            </a>
                            <a href="#" id="shortcutRecent" class="nav-link text-dark d-flex align-items-center py-2 px-2 rounded">
                                <i class="bi bi-clock-history me-2"></i>
                                <span>Recent</span>
                            </a>
                            <a href="#" id="shortcutStarred" class="nav-link text-dark d-flex align-items-center py-2 px-2 rounded">
                                <i class="bi bi-star me-2"></i>
                                <span>Starred</span>
                            </a>
                            <a href="#" id="shortcutTemplates" class="nav-link text-dark d-flex align-items-center py-2 px-2 rounded">
                                <i class="bi bi-clipboard me-2"></i>
                                <span>Templates</span>
                            </a>
                        </nav>
                    </div>
                </div>

                <!-- Files Section -->
                <div class="mb-4">
                    <div class="d-flex align-items-center justify-content-between mb-2">
                        <span class="fw-semibold text-uppercase small text-muted">Files</span>
                        <div class="btn-group btn-group-sm">
                            <button id="uploadBtn" class="btn btn-outline-secondary btn-sm" title="Upload File">
                                <i class="bi bi-upload"></i>
                            </button>
                            <button id="createFolderBtn" class="btn btn-outline-secondary btn-sm" title="New Folder">
                                <i class="bi bi-folder-plus"></i>
                            </button>
                            <button id="createFileBtn" class="btn btn-outline-secondary btn-sm" title="New File">
                                <i class="bi bi-file-plus"></i>
                            </button>
                            <button id="publishBtn" class="btn btn-outline-secondary btn-sm" title="Publish">
                                <i class="bi bi-cloud-upload"></i>
                            </button>
                        </div>
                    </div>
                    <div id="fileTree" class="file-tree" style="min-height: 200px;">
                        <!-- Loading placeholder -->
                        <div class="placeholder-glow">
                            <div class="placeholder col-10 mb-2"></div>
                            <div class="placeholder col-8 mb-2 ms-3"></div>
                            <div class="placeholder col-9 mb-2 ms-3"></div>
                            <div class="placeholder col-7 mb-2"></div>
                            <div class="placeholder col-11 mb-2 ms-3"></div>
                        </div>
                    </div>
                </div>

                <!-- Collapsible Spaces Section at Bottom -->
                <div class="mb-4">
                    <div class="d-flex align-items-center justify-content-between mb-2" id="spacesHeader" data-bs-toggle="collapse" data-bs-target="#spacesContent" role="button">
                        <div class="d-flex align-items-center">
                            <i class="bi bi-chevron-down me-2"></i>
                            <span class="fw-semibold text-uppercase small text-muted">Spaces</span>
                        </div>
                        <button id="createSpaceBtn" class="btn btn-outline-secondary btn-sm" title="New Space">
                            <i class="bi bi-plus-lg"></i>
                        </button>
                    </div>
                    <div id="spacesContent" class="collapse show">
                        <div id="spacesList" class="nav flex-column">
                            <!-- Loading placeholder -->
                            <div class="placeholder-glow">
                                <div class="d-flex align-items-center mb-2 p-2">
                                    <div class="placeholder rounded-circle me-2" style="width: 20px; height: 20px;"></div>
                                    <div class="placeholder col-8"></div>
                                </div>
                                <div class="d-flex align-items-center mb-2 p-2">
                                    <div class="placeholder rounded-circle me-2" style="width: 20px; height: 20px;"></div>
                                    <div class="placeholder col-7"></div>
                                </div>
                                <div class="d-flex align-items-center mb-2 p-2">
                                    <div class="placeholder rounded-circle me-2" style="width: 20px; height: 20px;"></div>
                                    <div class="placeholder col-9"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </aside>

            <!-- Resize Handle -->
            <div id="sidebarResizeHandle" class="sidebar-resize-handle"></div>

            <!-- Main Content Area -->
            <main id="mainContent" class="app-main p-4 overflow-auto">
                <!-- Home View -->
                <div id="homeView" class="view">
                    <div class="mb-4">
                        <h1 id="workspaceTitle" class="h2 mb-1">Welcome to the Wiki</h1>
                        <p id="workspaceSubtitle" class="text-muted">Your documentation workspace dashboard</p>
                    </div>

                    <!-- Home Content Area (for home.md) -->
                    <div id="homeContentArea" class="mb-4 hidden">
                        <div class="card">
                            <div class="card-body markdown-content">
                                <div id="homeContentBody">
                                    <!-- home.md content will be rendered here -->
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Content Sections -->
                    <div class="row g-4">
                        <!-- Recent Files Section -->
                        <div class="col-12 col-lg-6">
                            <div class="card h-100">
                                <div class="card-header d-flex justify-content-between align-items-center">
                                    <div class="d-flex align-items-center">
                                        <i class="bi bi-clock-history me-2 text-primary"></i>
                                        <h5 class="mb-0">Recent Files</h5>
                                    </div>
                                    <button id="refreshRecentBtn" class="btn btn-outline-secondary btn-sm">
                                        <i class="bi bi-arrow-clockwise"></i>
                                    </button>
                                </div>
                                <div class="card-body">
                                    <div id="recentFilesContent">
                                        <div class="text-center text-muted py-4">
                                            <i class="bi bi-clock-history display-4 mb-2"></i>
                                            <p>No recent markdown files found</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Starred Files Section -->
                        <div class="col-12 col-lg-6">
                            <div class="card h-100">
                                <div class="card-header">
                                    <div class="d-flex align-items-center">
                                        <i class="bi bi-star me-2 text-warning"></i>
                                        <h5 class="mb-0">Starred Files</h5>
                                    </div>
                                </div>
                                <div class="card-body">
                                    <div id="starredFilesContent">
                                        <div class="text-center text-muted py-4">
                                            <i class="bi bi-star display-4 mb-2"></i>
                                            <p>No starred markdown files found</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Templates Section -->
                        <div class="col-12" id="templatesSection">
                            <div class="card">
                                <div class="card-header d-flex justify-content-between align-items-center">
                                    <div class="d-flex align-items-center">
                                        <i class="bi bi-clipboard me-2 text-success"></i>
                                        <h5 class="mb-0">Templates</h5>
                                    </div>
                                    <button id="templatesNewBtn" class="btn btn-outline-success btn-sm" title="New Template">
                                        <i class="bi bi-plus-lg"></i>
                                    </button>
                                </div>
                                <div class="card-body">
                                    <div id="templatesContent">
                                        <!-- Templates will be loaded here -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Spaces View -->
                <div id="spacesView" class="view hidden">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h1 class="h2">Spaces</h1>
                        <button id="createSpaceFromView" class="btn btn-primary">
                            <i class="bi bi-plus-lg me-2"></i>Create Space
                        </button>
                    </div>
                    <div id="spacesGrid" class="row g-3">
                        <!-- Dynamic content -->
                    </div>
                </div>

                <!-- Space Detail View -->
                <div id="spaceView" class="view hidden">
                    <div class="space-header">
                        <nav class="breadcrumb">
                            <a href="#" id="backToHome">Home</a>
                            <span class="breadcrumb-separator">/</span>
                            <span id="currentSpaceName"></span>
                        </nav>
                        <div class="space-actions">
                            <button id="createDocInSpace" class="btn btn-primary">+ New Document</button>
                            <button id="createFolderInSpace" class="btn btn-secondary">+ New Folder</button>
                        </div>
                    </div>
                    
                    <div class="space-content-sections">
                        <!-- Recent Files in Space -->
                        <section class="space-section">
                            <div class="section-header">
                                <div class="section-title">
                                    <svg width="20" height="20" class="section-icon">
                                        <use href="#icon-history"></use>
                                    </svg>
                                    <h2>Recent Files</h2>
                                </div>
                            </div>
                            <div id="spaceRecentFiles" class="files-grid">
                                <!-- Recent files will be loaded here -->
                            </div>
                        </section>

                        <!-- Starred Files in Space -->
                        <section class="space-section">
                            <div class="section-header">
                                <div class="section-title">
                                    <svg width="20" height="20" class="section-icon">
                                        <use href="#icon-star"></use>
                                    </svg>
                                    <h2>Starred Files</h2>
                                </div>
                            </div>
                            <div id="spaceStarredFiles" class="files-grid">
                                <!-- Starred files will be loaded here -->
                            </div>
                        </section>

                        <!-- Root Files and Folders -->
                        <section class="space-section">
                            <div class="section-header">
                                <div class="section-title">
                                    <svg width="20" height="20" class="section-icon">
                                        <use href="#icon-folder"></use>
                                    </svg>
                                    <h2>Files & Folders</h2>
                                </div>
                            </div>
                            <div id="spaceRootItems" class="items-grid">
                                <!-- Root level files and folders will be loaded here -->
                            </div>
                        </section>
                    </div>
                </div>

                <!-- Editor View -->
                <div id="editorView" class="view hidden">
                    <div class="editor-container">
                        <div class="editor-header">
                            <nav class="breadcrumb">
                                <a href="#" id="editorBackToSpace" class="text-decoration-none">Space</a>
                                <span class="breadcrumb-separator">/</span>
                                <span id="editorDocTitle" class="text-muted"></span>
                            </nav>
                            <div class="editor-actions d-flex gap-2">
                                <button id="saveDoc" class="btn btn-primary btn-sm">
                                    <i class="bi bi-check-lg me-1"></i>
                                    Save
                                </button>
                                <button id="previewDoc" class="btn btn-outline-secondary btn-sm">
                                    <i class="bi bi-eye me-1"></i>
                                    Preview
                                </button>
                                <button id="closeEditor" class="btn btn-outline-secondary btn-sm">
                                    <i class="bi bi-x-lg me-1"></i>
                                    Close
                                </button>
                            </div>
                        </div>
                        
                        <div class="editor-main">
                            <div id="markdownEditor" class="editor-pane">
                                <div class="editor-toolbar">
                                    <div class="toolbar-group">
                                        <button id="boldBtn" class="btn btn-outline-secondary btn-sm" title="Bold (Ctrl+B)">
                                            <i class="bi bi-type-bold"></i>
                                        </button>
                                        <button id="italicBtn" class="btn btn-outline-secondary btn-sm" title="Italic (Ctrl+I)">
                                            <i class="bi bi-type-italic"></i>
                                        </button>
                                        <button id="codeBtn" class="btn btn-outline-secondary btn-sm" title="Inline Code">
                                            <i class="bi bi-code"></i>
                                        </button>
                                    </div>
                                    <div class="toolbar-separator"></div>
                                    <div class="toolbar-group">
                                        <button id="h1Btn" class="btn btn-outline-secondary btn-sm" title="Heading 1">H1</button>
                                        <button id="h2Btn" class="btn btn-outline-secondary btn-sm" title="Heading 2">H2</button>
                                        <button id="h3Btn" class="btn btn-outline-secondary btn-sm" title="Heading 3">H3</button>
                                    </div>
                                    <div class="toolbar-separator"></div>
                                    <div class="toolbar-group">
                                        <button id="listBtn" class="btn btn-outline-secondary btn-sm" title="Unordered List">
                                            <i class="bi bi-list-ul"></i>
                                        </button>
                                        <button id="numberedListBtn" class="btn btn-outline-secondary btn-sm" title="Ordered List">
                                            <i class="bi bi-list-ol"></i>
                                        </button>
                                        <button id="linkBtn" class="btn btn-outline-secondary btn-sm" title="Link">
                                            <i class="bi bi-link"></i>
                                        </button>
                                    </div>
                                </div>
                                <textarea id="editorTextarea" placeholder="Start writing..."></textarea>
                            </div>
                            <div id="previewPane" class="preview-pane hidden">
                                <div class="preview-header">
                                    <h3>Preview</h3>
                                </div>
                                <div id="previewContent" class="preview-content markdown-content"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Document View -->
                <div id="documentView" class="view hidden">
                    <div class="document-container">
                        <div class="document-header">
                            <nav class="breadcrumb">
                                <a href="#" id="docBackToSpace" class="text-decoration-none">Space</a>
                                <span class="breadcrumb-separator">/</span>
                                <span id="currentDocTitle" class="text-muted"></span>
                            </nav>
                            <div class="document-actions d-flex gap-2">
                                <button id="editDocBtn" class="btn btn-primary btn-sm">
                                    <i class="bi bi-pencil me-1"></i>
                                    Edit
                                </button>
                                <button id="starDocBtn" class="btn btn-outline-secondary btn-sm star-btn">
                                    <i class="bi bi-star me-1"></i>
                                    <span class="star-text">Star</span>
                                </button>
                                <button id="downloadDocBtn" class="btn btn-outline-secondary btn-sm">
                                    <i class="bi bi-download me-1"></i>
                                    Download
                                </button>
                            </div>
                        </div>
                        <!-- Content will be inserted directly here by JavaScript -->
                    </div>
                </div>

                <!-- Search Results View -->
                <div id="searchView" class="view hidden">
                    <div class="view-header">
                        <h1>Search Results</h1>
                        <span id="searchQuery" class="search-query"></span>
                    </div>
                    <div id="searchResults" class="search-results">
                        <!-- Dynamic content -->
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Modals -->
    <div id="createSpaceModal" class="modal hidden">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header border-bottom-0 pb-0">
                <h5 class="modal-title">Create New Space</h5>
                <button id="closeCreateSpaceModal" class="btn-close" aria-label="Close"></button>
            </div>
            <form id="createSpaceForm" class="p-3">
                <div class="mb-3">
                    <label for="spaceName" class="form-label">Space Name</label>
                    <input type="text" class="form-control" id="spaceName" name="spaceName" placeholder="My Space" required>
                </div>
                <div class="mb-3">
                    <label for="spaceDescription" class="form-label">Description</label>
                    <textarea class="form-control" id="spaceDescription" name="spaceDescription" rows="2" placeholder="Brief description of this space"></textarea>
                </div>
                <div class="mb-3">
                    <label for="spaceVisibility" class="form-label">Visibility</label>
                    <select class="form-select" id="spaceVisibility" name="spaceVisibility">
                        <option value="private">Private</option>
                        <option value="team">Team</option>
                        <option value="public">Public</option>
                    </select>
                </div>
                <div class="mb-3">
                    <label for="spacePermissions" class="form-label">Permissions</label>
                    <select class="form-select" id="spacePermissions" name="spacePermissions">
                        <option value="read-write">Read-Write</option>
                        <option value="read-only">Read-Only</option>
                    </select>
                </div>
                <div class="mb-3">
                    <label for="spacePath" class="form-label">Folder Path</label>
                    <div class="input-group">
                        <input type="text" class="form-control" id="spacePath" name="spacePath" placeholder="documents-my-space" required>
                        <button class="btn btn-outline-secondary" type="button" id="browseSpaceFolder" title="Browse folder">
                            <i class="bi bi-folder2-open"></i>
                        </button>
                    </div>
                    <small class="form-text text-muted">Relative path from application root (e.g., documents-my-space)</small>
                </div>
                <div class="d-flex justify-content-end gap-2 pt-2">
                    <button type="button" id="cancelCreateSpace" class="btn btn-secondary">Cancel</button>
                    <button type="submit" class="btn btn-primary">Create Space</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Create Folder Modal -->
    <div id="createFolderModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Create New Folder</h2>
                <button id="closeCreateFolderModal" class="modal-close">
                    <svg width="16" height="16">
                        <use href="#icon-x"></use>
                    </svg>
                </button>
            </div>
            <form id="createFolderForm">
                <div class="form-group">
                    <label for="folderName">Folder Name</label>
                    <input type="text" id="folderName" name="folderName" required>
                </div>
                <div class="form-group" id="folderLocationInfo" style="display: none;">
                    <small class="text-muted">Location: <span id="folderLocationText">Root</span></small>
                </div>
                <div class="modal-actions">
                    <button type="button" id="cancelCreateFolder" class="btn btn-secondary">Cancel</button>
                    <button type="submit" class="btn btn-primary">Create Folder</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Create File Modal -->
    <div id="createFileModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Create New File</h2>
                <button id="closeCreateFileModal" class="modal-close">
                    <svg width="16" height="16">
                        <use href="#icon-x"></use>
                    </svg>
                </button>
            </div>
            <form id="createFileForm" class="p-3">
                <div class="mb-3">
                    <label for="fileName" class="form-label">File Name</label>
                    <input type="text" id="fileName" name="fileName" class="form-control" placeholder="MyDocument.md" required>
                </div>
                <div class="mb-3">
                    <label for="fileLocation" class="form-label">Location</label>
                    <select id="fileLocation" name="fileLocation" class="form-select">
                        <option value="">Root</option>
                        <!-- Dynamic options will be added here -->
                    </select>
                </div>
                <div class="mb-3">
                    <label for="fileTemplate" class="form-label">Template (Optional)</label>
                    <select id="fileTemplate" name="fileTemplate" class="form-select">
                        <option value="">Blank Document</option>
                        <option value="basic">Basic Article</option>
                        <option value="api">API Documentation</option>
                        <option value="meeting">Meeting Notes</option>
                        <option value="requirements">Requirements Doc</option>
                    </select>
                </div>
                <div class="modal-actions d-flex justify-content-end gap-2">
                    <button type="button" id="cancelCreateFile" class="btn btn-secondary">Cancel</button>
                    <button type="submit" class="btn btn-primary">Create File</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Rename Modal -->
    <div id="renameModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Rename <span id="renameItemType">Item</span></h2>
                <button id="closeRenameModal" class="modal-close">
                    <svg width="16" height="16">
                        <use href="#icon-x"></use>
                    </svg>
                </button>
            </div>
            <form id="renameForm">
                <div class="form-group">
                    <label for="newItemName">New Name</label>
                    <input type="text" id="newItemName" name="newItemName" required>
                </div>
                <div class="modal-actions">
                    <button type="button" id="cancelRename" class="btn btn-secondary">Cancel</button>
                    <button type="submit" class="btn btn-primary">Rename</button>
                </div>
            </form>
        </div>
    </div>

    <!-- User Profile Modal -->
    <div id="userProfileModal" class="modal hidden">
        <div class="modal-content user-profile-modal">
            <div class="modal-header">
                <h2>User Profile</h2>
                <button id="closeUserProfileModal" class="modal-close">
                    <svg width="16" height="16">
                        <use href="#icon-x"></use>
                    </svg>
                </button>
            </div>
            <form id="userProfileForm">
                <div class="profile-section">
                    <div class="profile-avatar-section">
                        <div class="profile-avatar-large">
                            <span id="profileInitials">AD</span>
                        </div>
                        <button type="button" id="changeAvatarBtn" class="btn btn-secondary">
                            <i class="fas fa-camera"></i>
                            Change Avatar
                        </button>
                    </div>
                    
                    <div class="profile-form-section">
                        <div class="form-group">
                            <label for="profileName">Full Name</label>
                            <input type="text" id="profileName" name="profileName" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="profileEmail">Email Address</label>
                            <input type="email" id="profileEmail" name="profileEmail" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="profileRole">Role</label>
                            <select id="profileRole" name="profileRole">
                                <option value="administrator">Administrator</option>
                                <option value="editor">Editor</option>
                                <option value="viewer">Viewer</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="profileBio">Bio</label>
                            <textarea id="profileBio" name="profileBio" rows="3" placeholder="Tell us about yourself..."></textarea>
                        </div>
                        
                        <div class="form-group">
                            <label for="profileLocation">Location</label>
                            <input type="text" id="profileLocation" name="profileLocation" placeholder="City, Country">
                        </div>
                        
                        <div class="form-group">
                            <label for="profileTimezone">Timezone</label>
                            <select id="profileTimezone" name="profileTimezone">
                                <option value="UTC">UTC</option>
                                <option value="America/New_York">Eastern Time</option>
                                <option value="America/Chicago">Central Time</option>
                                <option value="America/Denver">Mountain Time</option>
                                <option value="America/Los_Angeles">Pacific Time</option>
                                <option value="Europe/London">London</option>
                                <option value="Europe/Paris">Paris</option>
                                <option value="Asia/Tokyo">Tokyo</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <div class="profile-settings-section">
                    <h3>Preferences</h3>
                    
                    <div class="form-group checkbox-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="emailNotifications" name="emailNotifications" checked>
                            <span class="checkmark"></span>
                            Email notifications
                        </label>
                    </div>
                    
                    <div class="form-group checkbox-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="darkMode" name="darkMode">
                            <span class="checkmark"></span>
                            Dark mode (coming soon)
                        </label>
                    </div>
                    
                    <div class="form-group">
                        <label for="defaultLanguage">Default Language</label>
                        <select id="defaultLanguage" name="defaultLanguage">
                            <option value="en">English</option>
                            <option value="es">Spanish</option>
                            <option value="fr">French</option>
                            <option value="de">German</option>
                            <option value="ja">Japanese</option>
                        </select>
                    </div>
                </div>
                
                <div class="modal-actions">
                    <button type="button" id="cancelUserProfile" class="btn btn-secondary">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Changes</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Context Menu for File Tree -->
    <div id="fileContextMenu" class="context-menu hidden">
        <div class="context-menu-item" id="contextCreateFolder">
            <svg width="16" height="16">
                <use href="#icon-folder"></use>
            </svg>
            <span>Create Folder</span>
        </div>
        <div class="context-menu-item" id="contextCreateFile">
            <svg width="16" height="16">
                <use href="#icon-plus"></use>
            </svg>
            <span>Create File</span>
        </div>
        <div class="context-menu-item" id="contextUpload">
            <svg width="16" height="16">
                <use href="#icon-share"></use>
            </svg>
            <span>Upload File</span>
        </div>
        <div class="context-menu-separator"></div>
        <div class="context-menu-item" id="contextRename">
            <svg width="16" height="16">
                <use href="#icon-edit"></use>
            </svg>
            <span>Rename</span>
        </div>
        <div class="context-menu-item context-menu-item-danger" id="contextDelete">
            <svg width="16" height="16">
                <use href="#icon-x"></use>
            </svg>
            <span>Delete</span>
        </div>
    </div>

    <!-- Hidden file input for uploads -->
    <input type="file" id="fileUploadInput" multiple style="display: none;">

    <div id="overlay" class="overlay hidden"></div>

    <!-- External Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/4.3.0/marked.min.js"></script>
    
    <!-- Application Scripts -->
    <script type="module" src="js/app.js"></script>
</body>
</html>